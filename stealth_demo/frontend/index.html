<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Interactive Stealth Scheme Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }
    
    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
      font-size: 2.5em;
      background: linear-gradient(45deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .section {
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }
    
    .section:hover {
      transform: translateY(-2px);
    }
    
    .section h3 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.3em;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
    }
    
    button {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px;
      font-weight: 600;
      transition: all 0.3s ease;
      min-width: 120px;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .output {
      margin-top: 10px;
      padding: 15px;
      border: 1px solid #ddd;
      background: #f8f9fa;
      border-radius: 8px;
      white-space: pre-wrap;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .output.success {
      border-color: #28a745;
      background: #f8fff9;
    }
    
    .output.error {
      border-color: #dc3545;
      background: #fff8f8;
      color: #dc3545;
    }
    
    select, input[type=text], input[type=number] {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 8px;
      margin: 5px 0;
      font-size: 1em;
      transition: border-color 0.3s ease;
    }
    
    select:focus, input[type=text]:focus, input[type=number]:focus {
      outline: none;
      border-color: #667eea;
    }
    
    .controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .inline-controls {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ccc;
      margin-right: 8px;
      display: inline-block;
    }
    
    .status-indicator.active {
      background: #28a745;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }
    
    .wide-section {
      grid-column: 1 / -1;
    }
    
    .data-list {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin: 10px 0;
    }
    
    .data-item {
      padding: 10px;
      border-bottom: 1px solid #eee;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    
    .data-item:hover {
      background-color: #f0f0f0;
    }
    
    .data-item:last-child {
      border-bottom: none;
    }
    
    .data-item.selected {
      background-color: #e3f2fd;
      border-left: 4px solid #667eea;
    }
    
    .item-header {
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
    }
    
    .item-details {
      font-size: 0.9em;
      color: #666;
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .hex-display {
      font-family: 'Courier New', monospace;
      font-size: 0.8em;
      color: #666;
      word-break: break-all;
    }
    
    .tabs {
      display: flex;
      border-bottom: 2px solid #ddd;
      margin-bottom: 20px;
    }
    
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.3s ease;
    }
    
    .tab.active {
      border-bottom-color: #667eea;
      color: #667eea;
      font-weight: bold;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê Interactive Stealth Scheme Demo</h1>
    
    <div class="grid">
      <!-- Setup Section with Parameter Selection -->
      <div class="section">
        <h3>üîß System Setup</h3>
        <div class="controls">
          <span class="status-indicator" id="setup-status"></span>
          <label>Select Parameter File:</label>
          <select id="param-select">
            <option value="">Loading parameter files...</option>
          </select>
          <button onclick="callSetup()" id="setup-btn">Initialize with Selected Param</button>
        </div>
        <div class="output" id="output-setup"></div>
      </div>

      <!-- Key Management Section -->
      <div class="section">
        <h3>üîë Key Management</h3>
        <div class="controls">
          <button onclick="callKeyGen()" id="keygen-btn">Generate New Key</button>
          <button onclick="loadKeyList()">Refresh Key List</button>
        </div>
        <div class="data-list" id="key-list"></div>
        <div class="output" id="output-keygen"></div>
      </div>

      <!-- Address Generation Section -->
      <div class="section">
        <h3>üìß Address Generation</h3>
        <div class="controls">
          <label>Select Key for Address Generation:</label>
          <select id="addr-key-select">
            <option value="">Select a key...</option>
          </select>
          <button onclick="callAddrGen()" id="addr-btn">Generate Address</button>
        </div>
        <div class="data-list" id="address-list"></div>
        <div class="output" id="output-addr"></div>
      </div>

      <!-- Address Verification Section -->
      <div class="section">
        <h3>üîç Address Verification</h3>
        <div class="controls">
          <label>Select Address to Verify:</label>
          <select id="verify-addr-select">
            <option value="">Select an address...</option>
          </select>
          <label>Select Key for Verification:</label>
          <select id="verify-key-select">
            <option value="">Select a key...</option>
          </select>
          <button onclick="callAddrVerify()" id="verify-btn">Verify Address</button>
        </div>
        <div class="output" id="output-verify"></div>
      </div>

      <!-- DSK Generation Section -->
      <div class="section">
        <h3>üîê DSK Generation</h3>
        <div class="controls">
          <label>Select Address:</label>
          <select id="dsk-addr-select">
            <option value="">Select an address...</option>
          </select>
          <label>Select Owner Key:</label>
          <select id="dsk-key-select">
            <option value="">Select a key...</option>
          </select>
          <button onclick="callDSKGen()" id="dsk-btn">Generate DSK</button>
        </div>
        <div class="data-list" id="dsk-list"></div>
        <div class="output" id="output-dsk"></div>
      </div>

      <!-- Signing Section -->
      <div class="section">
        <h3>‚úçÔ∏è Message Signing</h3>
        <div class="controls">
          <input type="text" id="message-input" placeholder="Enter message to sign..." value="Test transaction message">
          <label>Select DSK for Signing:</label>
          <select id="sign-dsk-select">
            <option value="">Select a DSK...</option>
          </select>
          <button onclick="callSign()" id="sign-btn">Sign Message</button>
        </div>
        <div class="output" id="output-sign"></div>
      </div>

      <!-- Signature Verification Section -->
      <div class="section wide-section">
        <h3>‚úÖ Signature Verification</h3>
        <div class="controls">
          <div class="inline-controls">
            <input type="text" id="verify-message-input" placeholder="Message to verify..." value="Test transaction message">
            <select id="verify-addr-for-sig-select">
              <option value="">Select address...</option>
            </select>
            <button onclick="callVerifySignature()" id="verify-sig-btn">Verify Signature</button>
          </div>
          <div class="inline-controls">
            <input type="text" id="q-sigma-input" placeholder="Q_sigma (signature component)...">
            <input type="text" id="h-input" placeholder="H (hash component)...">
          </div>
        </div>
        <div class="output" id="output-verify-sig"></div>
      </div>

      <!-- Identity Tracing Section -->
      <div class="section wide-section">
        <h3>üîç Identity Tracing</h3>
        <div class="controls">
          <div class="inline-controls">
            <label>Select Address to Trace:</label>
            <select id="trace-addr-select">
              <option value="">Select an address...</option>
            </select>
            <button onclick="callTrace()" id="trace-btn">Trace Identity</button>
          </div>
        </div>
        <div class="output" id="output-trace"></div>
      </div>
    </div>
  </div>

  <script>
    let state = {
      keys: [],
      addresses: [],
      dsks: [],
      traceKey: null,
      selectedKeyIndex: -1,
      selectedAddrIndex: -1,
      selectedDSKIndex: -1,
      setupComplete: false,
      currentParamFile: null
    };

    // Utility functions
    function showLoading(buttonId) {
      const btn = document.getElementById(buttonId);
      btn.disabled = true;
      const originalText = btn.textContent;
      btn.innerHTML = '<span class="loading"></span>' + originalText;
      return originalText;
    }

    function hideLoading(buttonId, originalText) {
      const btn = document.getElementById(buttonId);
      btn.disabled = false;
      btn.innerHTML = originalText;
    }

    function updateStatusIndicator(indicatorId, active = false) {
      const indicator = document.getElementById(indicatorId);
      if (active) {
        indicator.classList.add('active');
      } else {
        indicator.classList.remove('active');
      }
    }

    function displayOutput(outputId, content, isError = false) {
      const output = document.getElementById(outputId);
      output.innerHTML = content;
      output.className = 'output ' + (isError ? 'error' : 'success');
    }

    function truncateHex(hex, length = 16) {
      if (!hex) return '';
      if (hex.length <= length * 2) return hex;
      return hex.substring(0, length) + '...' + hex.substring(hex.length - 8);
    }

    // Load parameter files on startup
    async function loadParamFiles() {
      try {
        const res = await fetch('/param_files');
        if (!res.ok) throw new Error('Failed to load parameter files');
        
        const data = await res.json();
        const select = document.getElementById('param-select');
        
        select.innerHTML = '<option value="">Select a parameter file...</option>';
        
        data.param_files.forEach(file => {
          const option = document.createElement('option');
          option.value = file.name;
          option.textContent = `${file.name} (${file.size} bytes)`;
          select.appendChild(option);
        });
        
        if (data.current) {
          select.value = data.current;
          state.currentParamFile = data.current;
        }
        
      } catch (error) {
        displayOutput('output-setup', 'Error loading parameter files: ' + error.message, true);
      }
    }

    // API calls
    async function callSetup() {
      const originalText = showLoading('setup-btn');
      try {
        const paramFile = document.getElementById('param-select').value;
        if (!paramFile) {
          throw new Error('Please select a parameter file');
        }
        
        const res = await fetch('/setup', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ param_file: paramFile })
        });
        
        if (!res.ok) throw new Error('Setup failed');
        
        const data = await res.json();
        state.traceKey = data;
        state.setupComplete = true;
        state.currentParamFile = paramFile;
        
        updateStatusIndicator('setup-status', true);
        displayOutput('output-setup', `‚úÖ System Initialized Successfully!
üìÑ Parameter File: ${paramFile}
üîë Trace Key: ${truncateHex(data.TK_hex)}
üîê K Value: ${truncateHex(data.k_hex)}
üìä G1 Size: ${data.g1_size} bytes
üìä Zr Size: ${data.zr_size} bytes
‚úÖ Status: ${data.status}`);
        
        // Reset all lists
        state.keys = [];
        state.addresses = [];
        state.dsks = [];
        updateAllLists();
        
      } catch (error) {
        displayOutput('output-setup', 'Error: ' + error.message, true);
      }
      hideLoading('setup-btn', originalText);
    }

    async function callKeyGen() {
      if (!state.setupComplete) {
        alert("Please run Setup first!");
        return;
      }
      
      const originalText = showLoading('keygen-btn');
      try {
        const res = await fetch('/keygen');
        if (!res.ok) throw new Error('KeyGen failed');
        
        const data = await res.json();
        state.keys.push(data);
        
        updateAllLists();
        displayOutput('output-keygen', `‚úÖ Key Generated Successfully!
üÜî Key ID: ${data.id}
üîì Public Key A: ${truncateHex(data.A_hex)}
üîì Public Key B: ${truncateHex(data.B_hex)}
üîê Private Key a: ${truncateHex(data.a_hex)}
üîê Private Key b: ${truncateHex(data.b_hex)}`);
        
      } catch (error) {
        displayOutput('output-keygen', 'Error: ' + error.message, true);
      }
      hideLoading('keygen-btn', originalText);
    }

    async function loadKeyList() {
      try {
        const res = await fetch('/keylist');
        if (!res.ok) throw new Error('Failed to load keys');
        
        state.keys = await res.json();
        updateAllLists();
        
      } catch (error) {
        displayOutput('output-keygen', 'Error loading keys: ' + error.message, true);
      }
    }

    async function callAddrGen() {
      if (!state.setupComplete) {
        alert("Please run Setup first!");
        return;
      }
      
      const keyIndex = parseInt(document.getElementById('addr-key-select').value);
      if (isNaN(keyIndex)) {
        alert("Please select a key!");
        return;
      }
      
      const originalText = showLoading('addr-btn');
      try {
        const res = await fetch('/addrgen', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ key_index: keyIndex })
        });
        
        if (!res.ok) throw new Error('Address generation failed');
        
        const data = await res.json();
        state.addresses.push(data);
        
        updateAllLists();
        displayOutput('output-addr', `‚úÖ Address Generated Successfully!
üÜî Address ID: ${data.id}
üë§ Owner Key: ${data.key_id}
üè† Address: ${truncateHex(data.addr_hex)}
üé≤ R1: ${truncateHex(data.r1_hex)}
üé≤ R2: ${truncateHex(data.r2_hex)}
üîí C: ${truncateHex(data.c_hex)}`);
        
      } catch (error) {
        displayOutput('output-addr', 'Error: ' + error.message, true);
      }
      hideLoading('addr-btn', originalText);
    }

    async function callAddrVerify() {
      const addrIndex = parseInt(document.getElementById('verify-addr-select').value);
      const keyIndex = parseInt(document.getElementById('verify-key-select').value);
      
      if (isNaN(addrIndex) || isNaN(keyIndex)) {
        alert("Please select both an address and a key!");
        return;
      }
      
      const originalText = showLoading('verify-btn');
      try {
        const res = await fetch('/verify_addr', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            address_index: addrIndex,
            key_index: keyIndex
          })
        });
        
        if (!res.ok) throw new Error('Address verification failed');
        
        const data = await res.json();
        displayOutput('output-verify', `üîç Address Verification Results:
üìß Address: ${data.address_id}
üîë Key Used: ${data.key_id}
üë§ Is Owner: ${data.is_owner ? '‚úÖ Yes' : '‚ùå No'}
‚úÖ Verification Result: ${data.valid ? '‚úÖ Valid' : '‚ùå Invalid'}
üìä Status: ${data.status}`);
        
      } catch (error) {
        displayOutput('output-verify', 'Error: ' + error.message, true);
      }
      hideLoading('verify-btn', originalText);
    }

    async function callDSKGen() {
      const addrIndex = parseInt(document.getElementById('dsk-addr-select').value);
      const keyIndex = parseInt(document.getElementById('dsk-key-select').value);
      
      if (isNaN(addrIndex) || isNaN(keyIndex)) {
        alert("Please select both an address and a key!");
        return;
      }
      
      const originalText = showLoading('dsk-btn');
      try {
        const res = await fetch('/dskgen', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            address_index: addrIndex,
            key_index: keyIndex
          })
        });
        
        if (!res.ok) throw new Error('DSK generation failed');
        
        const data = await res.json();
        state.dsks.push(data);
        
        updateAllLists();
        displayOutput('output-dsk', `‚úÖ DSK Generated Successfully!
üÜî DSK ID: ${data.id}
üîê DSK: ${truncateHex(data.dsk_hex)}
üìß For Address: ${data.address_id}
üë§ Owner Key: ${data.key_id}
üè† Address: ${truncateHex(data.for_address)}`);
        
      } catch (error) {
        displayOutput('output-dsk', 'Error: ' + error.message, true);
      }
      hideLoading('dsk-btn', originalText);
    }

    async function callSign() {
      const message = document.getElementById('message-input').value;
      const dskIndex = parseInt(document.getElementById('sign-dsk-select').value);
      
      if (!message.trim()) {
        alert("Please enter a message to sign!");
        return;
      }
      
      if (isNaN(dskIndex)) {
        alert("Please select a DSK!");
        return;
      }
      
      const originalText = showLoading('sign-btn');
      try {
        const res = await fetch('/sign', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            message: message,
            dsk_index: dskIndex
          })
        });
        
        if (!res.ok) throw new Error('Signing failed');
        
        const data = await res.json();
        
        // Auto-fill verification fields
        document.getElementById('verify-message-input').value = message;
        document.getElementById('q-sigma-input').value = data.q_sigma_hex;
        document.getElementById('h-input').value = data.h_hex;
        document.getElementById('verify-addr-for-sig-select').value = data.address_index;
        
        displayOutput('output-sign', `‚úÖ Message Signed Successfully!
üìù Message: "${message}"
üîê DSK Used: ${data.dsk_id}
üìß Address: ${data.address_id}
üîè Q_sigma: ${truncateHex(data.q_sigma_hex)}
üîë H: ${truncateHex(data.h_hex)}`);
        
      } catch (error) {
        displayOutput('output-sign', 'Error: ' + error.message, true);
      }
      hideLoading('sign-btn', originalText);
    }

    async function callVerifySignature() {
      const message = document.getElementById('verify-message-input').value;
      const qSigma = document.getElementById('q-sigma-input').value;
      const h = document.getElementById('h-input').value;
      const addrIndex = parseInt(document.getElementById('verify-addr-for-sig-select').value);
      
      if (!message.trim() || !qSigma.trim() || !h.trim() || isNaN(addrIndex)) {
        alert("Please fill in all fields!");
        return;
      }
      
      const originalText = showLoading('verify-sig-btn');
      try {
        const res = await fetch('/verify_signature', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            message: message,
            q_sigma_hex: qSigma,
            h_hex: h,
            address_index: addrIndex
          })
        });
        
        if (!res.ok) throw new Error('Signature verification failed');
        
        const data = await res.json();
        displayOutput('output-verify-sig', `üîç Signature Verification Results:
üìù Message: "${message}"
üìß Address: ${data.address_id}
‚úÖ Verification Result: ${data.valid ? '‚úÖ Valid Signature' : '‚ùå Invalid Signature'}
üìä Status: ${data.status}`);
        
      } catch (error) {
        displayOutput('output-verify-sig', 'Error: ' + error.message, true);
      }
      hideLoading('verify-sig-btn', originalText);
    }

    async function callTrace() {
      const addrIndex = parseInt(document.getElementById('trace-addr-select').value);
      
      if (isNaN(addrIndex)) {
        alert("Please select an address to trace!");
        return;
      }
      
      const originalText = showLoading('trace-btn');
      try {
        const res = await fetch('/trace', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ address_index: addrIndex })
        });
        
        if (!res.ok) throw new Error('Identity tracing failed');
        
        const data = await res.json();
        displayOutput('output-trace', `üîç Identity Tracing Results:
üìß Traced Address: ${data.address_id}
üîç Recovered B: ${truncateHex(data.recovered_b_hex)}
üë§ Original Owner: ${data.original_owner.key_id}
üîë Original B: ${truncateHex(data.original_owner.B_hex)}
üéØ Perfect Match: ${data.perfect_match ? '‚úÖ Yes' : '‚ùå No'}
${data.matched_key ? `‚úÖ Matched Key: ${data.matched_key.id}` : '‚ö†Ô∏è No exact match found'}
üìä Status: ${data.status}`);
        
      } catch (error) {
        displayOutput('output-trace', 'Error: ' + error.message, true);
      }
      hideLoading('trace-btn', originalText);
    }

    // Update all dropdown lists and data displays
    function updateAllLists() {
      updateKeySelects();
      updateAddressSelects();
      updateDSKSelects();
      updateDataLists();
    }

    function updateKeySelects() {
      const selects = ['addr-key-select', 'verify-key-select', 'dsk-key-select'];
      
      selects.forEach(selectId => {
        const select = document.getElementById(selectId);
        select.innerHTML = '<option value="">Select a key...</option>';
        
        state.keys.forEach((key, index) => {
          const option = document.createElement('option');
          option.value = index;
          option.textContent = `${key.id} - A: ${truncateHex(key.A_hex, 8)}`;
          select.appendChild(option);
        });
      });
    }

    function updateAddressSelects() {
      const selects = ['verify-addr-select', 'dsk-addr-select', 'trace-addr-select', 'verify-addr-for-sig-select'];
      
      selects.forEach(selectId => {
        const select = document.getElementById(selectId);
        select.innerHTML = '<option value="">Select an address...</option>';
        
        state.addresses.forEach((addr, index) => {
          const option = document.createElement('option');
          option.value = index;
          option.textContent = `${addr.id} - Owner: ${addr.key_id}`;
          select.appendChild(option);
        });
      });
    }

    function updateDSKSelects() {
      const select = document.getElementById('sign-dsk-select');
      select.innerHTML = '<option value="">Select a DSK...</option>';
      
      state.dsks.forEach((dsk, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = `${dsk.id} - For: ${dsk.address_id}`;
        select.appendChild(option);
      });
    }

    function updateDataLists() {
      // Update key list
      const keyList = document.getElementById('key-list');
      keyList.innerHTML = '';
      state.keys.forEach((key, index) => {
        const item = document.createElement('div');
        item.className = 'data-item';
        item.innerHTML = `
          <div class="item-header">${key.id}</div>
          <div class="item-details">A: ${truncateHex(key.A_hex, 12)}</div>
          <div class="item-details">B: ${truncateHex(key.B_hex, 12)}</div>
        `;
        keyList.appendChild(item);
      });
      
      // Update address list
      const addrList = document.getElementById('address-list');
      addrList.innerHTML = '';
      state.addresses.forEach((addr, index) => {
        const item = document.createElement('div');
        item.className = 'data-item';
        item.innerHTML = `
          <div class="item-header">${addr.id} (Owner: ${addr.key_id})</div>
          <div class="item-details hex-display">${truncateHex(addr.addr_hex, 20)}</div>
        `;
        addrList.appendChild(item);
      });
      
      // Update DSK list
      const dskList = document.getElementById('dsk-list');
      dskList.innerHTML = '';
      state.dsks.forEach((dsk, index) => {
        const item = document.createElement('div');
        item.className = 'data-item';
        item.innerHTML = `
          <div class="item-header">${dsk.id}</div>
          <div class="item-details">For: ${dsk.address_id} (Owner: ${dsk.key_id})</div>
          <div class="item-details hex-display">${truncateHex(dsk.dsk_hex, 16)}</div>
        `;
        dskList.appendChild(item);
      });
    }

    // Initialize page
    window.onload = function () {
      loadParamFiles();
      loadKeyList();
    };
  </script>
</body>
</html>